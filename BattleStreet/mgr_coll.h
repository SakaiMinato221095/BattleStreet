
//================================================
//=
//=	当たり判定管理の処理のヘッダー[mgr_coll.h]
//= Author Sakai Minato
//=
//================================================

//=======================================
//=	二重インクルード防止
//=======================================

#ifndef _MGR_COLL_H_		// このマクロが定義されなかったら
#define _MGR_COLL_H_		// 二重インクルード帽子のマクロを定義

//=======================================
//=	インクルード
//=======================================

#include "object.h"

//=======================================
//=	マクロ定義
//=======================================

#define COLLSION_NUM_MAX		(1024)	// 当たり判定の最大数

//=======================================
//=	前方宣言
//=======================================

class CColl;

//-======================================
//-	クラス定義
//-======================================

// 接触のクラス
class CMgrColl
{

public:

	// 当たり判定タグ
	typedef enum
	{
		TAG_NONE = 0,		// 効果なし
		TAG_PLAYER,			// プレイヤー
		TAG_ENEMY,			// 敵
		TAG_MAX
	}TAG;

	// 軸
	typedef enum
	{
		TYPE_SXIS_X = 0,	// X軸
		TYPE_SXIS_Y,		// Y軸
		TYPE_SXIS_Z,		// Z軸
		TYPE_SXIS_MAX,
	}TYPE_SXIS;

	// 接触の種類
	typedef enum
	{
		STATE_HIT_NONE = 0,		// 何もなし（初期）状態
		STATE_HIT_NORMAL,		// 通常接触の状態
		STATE_HIT_DEAD,			// 死亡接触の状態
		STATE_HIT_MAX
	}STATE_HIT;

	CMgrColl();
	~CMgrColl();

	HRESULT Init(void);
	void Uninit(void);
	void Update(void);
	void Draw(void);

	static CMgrColl *Create(void);

	bool Hit(int nNldxColl, TAG hitTag);
	bool HitSide(int nNldxColl, CMgrColl::TAG hitTag,  CMgrColl::TYPE_SXIS typeSxis);

	int Set(CColl *pColl);
	void Reset(int nNldx);

private:

	void SetHit(CColl* pCollMy, int nNldx, CObject* pObjPair);

	bool hitRectangle(D3DXVECTOR3 posMy, D3DXVECTOR3 sizeMy, D3DXVECTOR3 posPair, D3DXVECTOR3 sizePair);
	bool hitRectangleSide(float fPos, float fSize, float fPosPair, float fSizePair);

	CColl *m_apColl[COLLSION_NUM_MAX];	// 当たり判定の情報
	int m_nNldxMax;						// 現在の番号の最大数
};

#endif	// 二重インクルード防止の終了
